{% extends 'collabrate/base.html' %}
{% block title %}Draft Questions{% endblock %}
{% load static %}
{% load custom_tags %}

{% block head %}
<link rel="stylesheet" href="{% static 'course/create_form_info.css' %}">
<link rel="stylesheet" href="{% static 'course/course_landing.css' %}">
<link rel="stylesheet" href="{% static 'course/sidenav.css' %}">
<style>
          .top-banner {
            background-color: {{ course.color }}; 
        }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid p-0 m-0">
  <div class="row">

      <!-- Sidebar -->
      <div class="col-md-3 p-0 m-0">
          {% include "course/sidenav.html" %}
      </div>

      <div class="container col-md-6 mt-4" style="max-height: 85vh; overflow-y: auto;">
      

        <!-- Page Title / Form Name -->
        <div class="row">
          <div class="top-banner">
            <h1><strong>{{ course.code }} | </strong>{{ course.title }}  - {{ course_form.name}}</h1> 
        </div>
        </div>
      
        <!-- Start of the Form -->
        <form method="POST" action="{% url 'draft_questions' join_code=course.join_code course_form_id=course_form.id %}">
          {% csrf_token %}
      
          <!-- LIKERT QUESTIONS -->
          <h1>Likert Questions</h1>
          {% if course_form.num_likert > 0 %}
            {% for i in course_form.num_likert|times %}
              <!-- Each Question Card -->

              {% if forloop.last %}
              <p id="last-likert"></p>
            {% endif %}


              <div class="card mb-3 shadow-sm">
                <div class="card-body">

                  <!-- Question Number and Header -->
                  <div class="d-flex align-items-center mb-2">
                    
                    <!-- Circle or Badge for question number -->
                    <div class="me-3 text-white" 
                         style="width: 30px; height: 30px; border-radius: 50%; background-color: #ff4e4e; display: flex; align-items: center; justify-content: center;">
                      <strong>{{ forloop.counter }}</strong>
                    </div>

                    <div class="flex-grow-1">
                      <input type="text" 
                             name="likert_question_title_{{ i }}" 
                             class="form-control" 
                             placeholder="Enter Question"
                             aria-label="Question Title">
                    </div>
                  </div>
    

                  <div class="mt-3">
                    <!-- Option 1 -->
<div class="mb-3">
  <div class="d-flex align-items-center">
    <div class="me-2" 
         style="border: 1px solid black; width: 15px; height: 15px; border-radius: 50%; background-color: {{ course_form.color_1 }}"></div>
    <label for="likert_{{ i }}_label_1" class="ms-1 mb-0">
      <input type="text" class="form-control-inline" value="Strongly Disagree" 
             name="likert_{{ i }}_label_1" 
             style="width: auto; display: inline-block;" />
    </label>
  </div>
</div>

<!-- Option 2 -->
<div class="mb-3">
  <div class="d-flex align-items-center">
    <div class="me-2" 
         style="border: 1px solid black; width: 15px; height: 15px; border-radius: 50%; background-color: {{ course_form.color_2 }}"></div>
    <label for="likert_{{ i }}_label_2" class="ms-1 mb-0">
      <input type="text" class="form-control-inline" value="Disagree" 
             name="likert_{{ i }}_label_2" 
             style="width: auto; display: inline-block;" />
    </label>
  </div>
</div>

<!-- Option 3 -->
<div class="mb-3">
  <div class="d-flex align-items-center">
    <div class="me-2" 
         style="border: 1px solid black; width: 15px; height: 15px; border-radius: 50%; background-color: {{ course_form.color_3 }}"></div>
    <label for="likert_{{ i }}_label_3" class="ms-1 mb-0">
      <input type="text" class="form-control-inline" value="Neutral" 
             name="likert_{{ i }}_label_3" 
             style="width: auto; display: inline-block;" />
    </label>
  </div>
</div>

<!-- Option 4 -->
<div class="mb-3">
  <div class="d-flex align-items-center">
    <div class="me-2" 
         style="border: 1px solid black; width: 15px; height: 15px; border-radius: 50%; background-color: {{ course_form.color_4 }}"></div>
    <label for="likert_{{ i }}_label_4" class="ms-1 mb-0">
      <input type="text" class="form-control-inline" value="Agree" 
             name="likert_{{ i }}_label_4" 
             style="width: auto; display: inline-block;" />
    </label>
  </div>
</div>

<!-- Option 5 -->
<div class="mb-3">
  <div class="d-flex align-items-center">
    <div class="me-2" 
         style="border: 1px solid black; width: 15px; height: 15px; border-radius: 50%; background-color: {{ course_form.color_5 }}"></div>
    <label for="likert_{{ i }}_label_5" class="ms-1 mb-0">
      <input type="text" class="form-control-inline" value="Strongly Agree" 
             name="likert_{{ i }}_label_5" 
             style="width: auto; display: inline-block;" />
    </label>
  </div>
</div>


                  </div>
                </div>
              </div>
            {% endfor %}
          {% endif %}

                  <!-- Hidden field for num_likert -->
        <input type="hidden" name="num_likert" value="{{ course_form.num_likert }}">

        <!-- Add new Likert question -->
        <button type="submit" name="action" value="add_likert" class="btn btn-success mt-3">+ Add Likert Question</button>
          
          <h1 id="middle">Open-ended Questions</h1>
          <!-- OPEN-ENDED QUESTIONS -->
          {% if course_form.num_open_ended > 0 %}
            {% for i in course_form.num_open_ended|times %}

            {% if forloop.last %}
            <p id="last-open"></p>
          {% endif %}

              <div class="card mb-3 shadow-sm">
                <div class="card-body">
                  <!-- Question Number and Header -->
                  <div class="d-flex align-items-center mb-2">
                    <div class="me-3 text-white" 
                         style="width: 30px; height: 30px; border-radius: 50%; background-color: #ff4e4e; display: flex; align-items: center; justify-content: center;">
                      <strong>{{ forloop.counter }}</strong>
                    </div>
                    <div class="flex-grow-1">
                      <input type="text" 
                             name="open_ended_question_title_{{ i }}" 
                             class="form-control" 
                             placeholder="Enter Question"
                             aria-label="Question Title">
                    </div>
                  </div>
      
                </div>
              </div>
            {% endfor %}
          {% endif %}

                    <!-- Hidden field for num_likert -->
        <input type="hidden" name="num_open" value="{{ course_form.num_open_ended }}">

        <!-- Add new Likert question -->
        <button type="submit" name="action" value="add_open" class="btn btn-success mt-3">+ Add Open-ended Question</button>
          

          <div class="text-end mt-4">
            <button type="submit" name="action" value="save" class="btn btn-primary px-4 py-2" style="font-weight: 500;">
              Save Form <span class="ms-1">&#x25BC;</span>
            </button>
          </div>
          <div class="text-end mt-4">
            <button type="submit" name="action" value="publish" class="btn btn-primary px-4 py-2" style="font-weight: 500;">
              Publish Form <span class="ms-1">&#x25BC;</span>
            </button>
          </div>
          <div class="text-end mt-4">
            <button type="submit" name="action" value="release" class="btn btn-primary px-4 py-2" style="font-weight: 500;">
              Release Form (debug) <span class="ms-1">&#x25BC;</span>
            </button>
          </div>
      
        </form>
      </div>
        <div class="col-md-3 p-0 m-0">
          {% include "course/view_forms_sidebar.html" %}
      </div>

  </div>
</div>
{% endblock %}
